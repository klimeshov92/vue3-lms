import{a as d,r as b,o as k,c as a,d as o,n as y,p as _,b as u,v as V,t as m,f as h,q as j,k as x,u as B,l,i as S,h as w,j as C}from"./index-CzP8FZvf.js";import"./custom-multiselect-CPXnysGl.js";import{E}from"./EditorComponent-DxSf7Gmz.js";const N={key:0},O={class:"form-page"},D={class:"form-field"},L={key:0,class:"error"},M={lass:"form-field form-field-full_width"},R={key:0,class:"error"},T={key:1,class:"loading"},z={__name:"LegalPageCreate",setup(U){x();const i=B(),s=d({title:"",content:""}),c=b(!1),p=()=>{j(i)},r=d({}),f=()=>(r.title=s.title?"":"Название обязательно!",r.content=s.content.trim()?"":"Содержание обязательно!",Object.values(r).every(t=>!t)),g=async()=>{if(!f()){console.error("Форма содержит ошибки:",r);return}try{console.log("Отправляем данные для создания объекта:",s);const t={title:s.title,content:s.content||""};console.log("JSON данные перед отправкой:",t);let e=localStorage.getItem("access_token");const n=S(e);if(e&&!n){i.push({name:"Login"});return}const v=await w.post(`${C}/legal_page/`,t,{headers:{Authorization:`Bearer ${e}`}});console.log("Объект создан:",v.data),i.push({name:"LegalPage"})}catch(t){t.response&&t.response.data?(Object.assign(r,t.response.data),console.error("Ошибка при создании объекта:",t.response.data)):console.error("Ошибка при создании объекта:",t.message)}};return k(async()=>{console.log("Компонент смонтирован, начинаем загрузку данных...");try{c.value=!0}catch(t){console.error("Ошибка при загрузке данных:",t)}}),(t,e)=>c.value?(l(),a("div",N,[o("div",O,[e[5]||(e[5]=o("div",{class:"form-header"},[o("h1",null,"Создание страницы")],-1)),o("form",{onSubmit:y(g,["prevent"]),class:"form",id:"form"},[o("div",D,[e[2]||(e[2]=o("label",{for:"title",class:"form-label"},"Заголовок:",-1)),_(o("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>s.title=n),id:"title",type:"text",class:"form-input",placeholder:"Введите заголовок",required:""},null,512),[[V,s.title]]),r.title?(l(),a("span",L,m(r.title),1)):u("",!0)]),o("div",M,[e[3]||(e[3]=o("label",{for:"desc",class:"form-label"},"Содержание:",-1)),h(E,{modelValue:s.content,"onUpdate:modelValue":e[1]||(e[1]=n=>s.content=n)},null,8,["modelValue"]),r.content?(l(),a("span",R,m(r.content),1)):u("",!0)])],32),o("div",{class:"form-menu button-group"},[e[4]||(e[4]=o("button",{type:"submit",class:"button",form:"form"},"Сохранить",-1)),o("button",{type:"button",onClick:p,class:"button"},"Отмена")])])])):(l(),a("div",T,[...e[6]||(e[6]=[o("div",null,"Загрузка данных...",-1)])]))}};export{z as default};
