import{a as u,r as y,o as k,c as r,d as o,n as h,p as c,b as p,v as g,t as f,q as j,k as O,u as S,l,i as x,h as B,j as V}from"./index-CfAZEXlX.js";import"./custom-multiselect-CMYyZ4s-.js";const z={key:0},D={class:"form-page"},q={class:"form-field"},w={key:0,class:"error"},C={class:"form-field"},M={key:0,class:"error"},N={key:1,class:"loading"},E={__name:"OrganizationCreate",setup(R){O();const i=S(),t=u({legal_name:"",tin:""}),d=y(!1),v=()=>{j(i)},a=u({}),_=()=>(a.legal_name=t.legal_name?"":"Юридическое название обязательно!",a.tin=t.tin?"":"ИНН обязателен!",Object.values(a).every(s=>!s)),b=async()=>{if(!_()){console.error("Форма содержит ошибки:",a);return}try{console.log("Отправляем данные для создания объекта:",t);const s={legal_name:t.legal_name,tin:t.tin};console.log("JSON данные перед отправкой:",s);let e=localStorage.getItem("access_token");const n=x(e);if(e&&!n){i.push({name:"Login"});return}const m=await B.post(`${V}/organizations/`,s,{headers:{Authorization:`Bearer ${e}`}});console.log("Объект создан:",m.data),localStorage.removeItem("userPermissions"),i.push({name:"OrganizationDetail",params:{id:m.data.id}})}catch(s){s.response&&s.response.data?(Object.assign(a,s.response.data),console.error("Ошибка при создании объекта:",s.response.data)):console.error("Ошибка при создании объекта:",s.message)}};return k(async()=>{console.log("Компонент смонтирован, начинаем загрузку данных...");try{d.value=!0}catch(s){console.error("Ошибка при загрузке данных:",s)}}),(s,e)=>d.value?(l(),r("div",z,[o("div",D,[e[5]||(e[5]=o("div",{class:"form-header"},[o("h1",null,"Создание организации")],-1)),o("form",{onSubmit:h(b,["prevent"]),class:"form",id:"form"},[o("div",q,[e[2]||(e[2]=o("label",{for:"legal_name",class:"form-label"},"Юридическое название:",-1)),c(o("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>t.legal_name=n),id:"legal_name",type:"text",class:"form-input",placeholder:"Введите юридическое название",required:""},null,512),[[g,t.legal_name]]),a.legal_name?(l(),r("span",w,f(a.legal_name),1)):p("",!0)]),o("div",C,[e[3]||(e[3]=o("label",{for:"tin",class:"form-label"},"ИНН:",-1)),c(o("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>t.tin=n),id:"tin",type:"number",class:"form-input",placeholder:"Введите ИНН",required:""},null,512),[[g,t.tin]]),a.tin?(l(),r("span",M,f(a.tin),1)):p("",!0)])],32),o("div",{class:"form-menu button-group"},[e[4]||(e[4]=o("button",{type:"submit",class:"button",form:"form"},"Сохранить",-1)),o("button",{type:"button",onClick:v,class:"button"},"Отмена")])])])):(l(),r("div",N,[...e[6]||(e[6]=[o("div",null,"Загрузка данных...",-1)])]))}};export{E as default};
