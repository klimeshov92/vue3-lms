import{k as j,u as O,r as b,g as A,c as l,l as s,b as a,d as t,F as h,E as P,t as c,e as $,w as f,m as g,i as M,h as T,j as C}from"./index-D06xwy0Y.js";import"./EditorComponent-C9e6ozj_.js";const D={key:0},G={key:0,class:"table-tab-table-outer"},w={class:"table-tab-table-inner"},S={key:0},x={class:"table-tab-menu"},B=["onClick"],V={key:1,class:"modal-overlay"},F={class:"modal"},L={class:"modal-header"},N={class:"modal-header-h2"},q={class:"minibutton-group modal-menu"},z={key:1},E={key:1},I={key:1,class:"tab-menu minibutton-group"},ct={__name:"AccountObjectPermissions",props:{contentTypeModel:String,state:Object,fetchObject:Function},setup(p){j();const v=O();b(!1);const e=p;console.log("contentTypeModel:",e.contentTypeModel),console.log("State:",e.state),console.log("fetchObject:",e.fetchObject);const u=b(!1),i=b(null),_=r=>{i.value=r,u.value=!0},m=()=>{u.value=!1},k=async r=>{let o=localStorage.getItem("access_token");const d=M(o);if(o&&!d){v.push({name:"Login"});return}try{await T.delete(`${C}/account_object_permissions/${r}/`,{headers:{Authorization:`Bearer ${o}`}}),await e.fetchObject(),m()}catch(n){console.error("Ошибка удаления объектного права пользователя:",n)}};return(r,o)=>{const d=A("router-link");return s(),l(h,null,[e.state.canViewAccountObjectPermission?(s(),l("div",D,[e.state.object.account_object_permissions&&e.state.object.account_object_permissions.length>0?(s(),l("div",G,[t("div",w,[t("table",null,[o[1]||(o[1]=t("thead",null,[t("tr",null,[t("th",null,"Владелец"),t("th",null,"Право"),t("th",null,"Тип контента"),t("th",null,"Объект"),t("th",null,"Действия")])],-1)),t("tbody",null,[(s(!0),l(h,null,P(e.state.object.account_object_permissions,n=>(s(),l("tr",{key:n.id},[t("td",null,c(n.user.str?n.user.str:"Нет данных"),1),t("td",null,c(n.permission.name?n.permission.name:"Нет данных"),1),t("td",null,c(n.permission.content_type.str?n.permission.content_type.str:"Нет данных"),1),t("td",null,c(n.content_object?n.content_object:"Нет данных"),1),t("td",null,[e.state.canDeleteAccountObjectPermission?(s(),l("div",S,[t("div",x,[e.state.canDeleteAccountObjectPermission?(s(),l("button",{key:0,onClick:y=>_(n),class:"table-tab-button"}," Удалить ",8,B)):a("",!0),u.value?(s(),l("div",V,[t("div",F,[t("div",L,[t("h2",N,"Удаление "+c(i.value.content_object||"Объектное право без пользователя")+" "+c(i.value.permission.name||"Безымянное объектное право"),1)]),t("div",q,[t("button",{onClick:o[0]||(o[0]=y=>k(i.value.id)),class:"minibutton"},"Подтвердить"),t("button",{onClick:m,class:"minibutton"},"Отменить")])])])):a("",!0)])])):(s(),l("div",z," - "))])]))),128))])])])])):(s(),l("div",E,[...o[2]||(o[2]=[t("div",{class:"none-border"},"Нет объектных прав",-1)])]))])):a("",!0),e.state.canAddAccountObjectPermission?(s(),l("div",I,[e.state.canAddAccountObjectPermission?(s(),$(d,{key:0,to:{name:"CreateAccountObjectPermission",query:{contentTypeModel:e.contentTypeModel,objectPk:e.state.object.id}},class:"minibutton"},{default:f(()=>[...o[3]||(o[3]=[g(" Добавить ",-1)])]),_:1},8,["to"])):a("",!0)])):a("",!0)],64)}}},R={key:0},U={key:0,class:"table-tab-table-outer"},H={class:"table-tab-table-inner"},J={key:0},K={class:"table-tab-menu"},Q=["onClick"],W={key:1,class:"modal-overlay"},X={class:"modal"},Y={class:"modal-header"},Z={class:"modal-header-h2"},tt={class:"minibutton-group modal-menu"},et={key:1},ot={key:1},nt={key:1,class:"tab-menu minibutton-group"},at={__name:"AccountsGroupObjectPermissions",props:{contentTypeModel:String,state:Object,fetchObject:Function},setup(p){j();const v=O();b(!1);const e=p;console.log("contentTypeModel:",e.contentTypeModel),console.log("State:",e.state),console.log("fetchObject:",e.fetchObject);const u=b(!1),i=b(null),_=r=>{i.value=r,u.value=!0},m=()=>{u.value=!1},k=async r=>{let o=localStorage.getItem("access_token");const d=M(o);if(o&&!d){v.push({name:"Login"});return}try{await T.delete(`${C}/accounts_group_object_permissions/${r}/`,{headers:{Authorization:`Bearer ${o}`}}),await e.fetchObject(),m()}catch(n){console.error("Ошибка удаления объектного права группы:",n)}};return(r,o)=>{const d=A("router-link");return s(),l(h,null,[e.state.canViewAccountsGroupObjectPermission?(s(),l("div",R,[e.state.object.accounts_group_object_permissions&&e.state.object.accounts_group_object_permissions.length>0?(s(),l("div",U,[t("div",H,[t("table",null,[o[1]||(o[1]=t("thead",null,[t("tr",null,[t("th",null,"Владелец"),t("th",null,"Право"),t("th",null,"Тип контента"),t("th",null,"Объект"),t("th",null,"Действия")])],-1)),t("tbody",null,[(s(!0),l(h,null,P(e.state.object.accounts_group_object_permissions,n=>(s(),l("tr",{key:n.id},[t("td",null,c(n.group.name?n.group.name:"Нет данных"),1),t("td",null,c(n.permission.name?n.permission.name:"Нет данных"),1),t("td",null,c(n.permission.content_type.str?n.permission.content_type.str:"Нет данных"),1),t("td",null,c(n.content_object?n.content_object:"Нет данных"),1),t("td",null,[e.state.canDeleteAccountsGroupObjectPermission?(s(),l("div",J,[t("div",K,[e.state.canDeleteAccountsGroupObjectPermission?(s(),l("button",{key:0,onClick:y=>_(n),class:"table-tab-button"}," Удалить ",8,Q)):a("",!0),u.value?(s(),l("div",W,[t("div",X,[t("div",Y,[t("h2",Z,"Удаление "+c(i.value.content_object||"Объектное право без пользователя")+" "+c(i.value.permission.name||"Безымянное объектное право"),1)]),t("div",tt,[t("button",{onClick:o[0]||(o[0]=y=>k(i.value.id)),class:"minibutton"},"Подтвердить"),t("button",{onClick:m,class:"minibutton"},"Отменить")])])])):a("",!0)])])):(s(),l("div",et," - "))])]))),128))])])])])):(s(),l("div",ot,[...o[2]||(o[2]=[t("div",{class:"none-border"},"Нет объектных прав",-1)])]))])):a("",!0),e.state.canAddAccountsGroupObjectPermission?(s(),l("div",nt,[e.state.canAddAccountsGroupObjectPermission?(s(),$(d,{key:0,to:{name:"CreateAccountsGroupObjectPermission",query:{contentTypeModel:e.contentTypeModel,objectPk:e.state.object.id}},class:"minibutton"},{default:f(()=>[...o[3]||(o[3]=[g(" Добавить ",-1)])]),_:1},8,["to"])):a("",!0)])):a("",!0)],64)}}};export{at as _,ct as a};
